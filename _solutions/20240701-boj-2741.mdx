---
title: "BOJ 2741 - N 찍기"
date: "2024-07-01"
description: "행렬 거듭제곱을 이용하여 피보나치 수를 빠르게 구하는 문제"
tags: ["구현"]
platform: "boj"
problem_number: "2741"
problem_url: "https://www.acmicpc.net/problem/2741"
difficulty: "브론즈 V"
language: "python"
---

## 문제

[BOJ 2741 - N 찍기](https://www.acmicpc.net/problem/2741)

> 자연수 N이 주어졌을 때, 1부터 N까지의 수를 한 줄에 하나씩 출력한다.

## 풀이

행렬 거듭제곱을 활용한 피보나치 수 계산 코드이다. 2x2 피보나치 행렬을 N+1번 거듭제곱하여 결과 행렬의 마지막 원소를 출력한다. 분할 정복을 통해 행렬 곱셈 횟수를 O(log N)으로 줄인다.

## 코드

```python
from sys import stdin

MOD = 1_000_000


def mat_mul(m1, m2):
    result = [[0 for _ in range(len(m2[0]))] for _ in range(len(m1))]
    for i, row in enumerate(m1):
        for j, col in enumerate(zip(*m2)):
            result[i][j] = sum([r * c for r, c in zip(row, col)]) % MOD
    return result


def get_power_of_mat(m, power):
    if power == 1:
        return m
    squared = get_power_of_mat(m, power // 2)
    if power % 2 == 0:
        return mat_mul(squared, squared)
    else:
        return mat_mul(m, mat_mul(squared, squared))


N = int(stdin.readline())
fibonacci_mat = [[1, 1], [1, 0]]
print(get_power_of_mat(fibonacci_mat, N + 1)[-1][-1])
```

## 복잡도

- 시간: O(log N)
- 공간: O(1)
