---
title: "BOJ 15684 - 사다리 조작"
date: "2023-04-06"
description: "구현, 브루트포스 알고리즘, 백트래킹 문제"
tags: ["구현", "브루트포스 알고리즘", "백트래킹"]
platform: "boj"
problem_number: "15684"
problem_url: "https://www.acmicpc.net/problem/15684"
difficulty: "골드 III"
language: "java"
---

## 문제

[BOJ 15684 - 사다리 조작](https://www.acmicpc.net/problem/15684)

## 풀이

백트래킹으로 가능한 경우를 탐색한다.

## 코드

```java
package day449;

import java.io.*;
import java.util.*;

public class Day424BOJ15684사다리조작 {
  static int N, M, H, ans = 0;
  static int[][] arr;
  static boolean flag = false;

  public static void main(String[] args) throws IOException {
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    StringTokenizer st = new StringTokenizer(br.readLine());

    N = Integer.parseInt(st.nextToken());
    M = Integer.parseInt(st.nextToken());
    H = Integer.parseInt(st.nextToken());

    arr = new int[H + 1][N + 1];

    if (M != 0) {
      for (int i = 0; i < M; i++) {
        st = new StringTokenizer(br.readLine());
        int a = Integer.parseInt(st.nextToken());
        int b = Integer.parseInt(st.nextToken());

        arr[a][b] = 1;
        arr[a][b + 1] = 2;
      }
    }
    for (int i = 0; i <= 3; i++) {
      ans = i;
      dfs(1, 0);
      if (flag) {
        break;
      }
    }

    if (flag) {
      System.out.println(ans);
      return;
    }
    if (ans > 3) {
      System.out.println(-1);
    } else {
      System.out.println(-1);
    }
  }

  private static void dfs(int x, int depth) {
    if (ans == depth) {
      if (check()) {
        flag = true;
      }
      return;
    }

    for (int i = x; i <= H; i++) {
      for (int j = 1; j < N; j++) {
        if (arr[i][j] == 0 && arr[i][j + 1] == 0) {
          arr[i][j] = 1;
          arr[i][j + 1] = 2;

          dfs(i, depth + 1);

          arr[i][j] = 0;
          arr[i][j + 1] = 0;
        }
      }
    }
  }

  private static boolean check() {
    for (int i = 1; i <= N; i++) {
      int nx = i;
      int ny = 1;
      while (ny <= H) {
        if (arr[ny][nx] == 1) {
          nx++;
        } else if (arr[ny][nx] == 2) {
          nx--;
        }
        ny++;
      }
      if (nx != i) {
        return false;
      }
    }
    return true;
  }
}
```

## 복잡도

- 시간: O(N!)
- 공간: O(N)
