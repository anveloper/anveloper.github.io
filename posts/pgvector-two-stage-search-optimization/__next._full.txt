1:"$Sreact.fragment"
2:I[28739,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js"],"Providers"]
3:I[63720,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js"],"NavBar"]
4:I[25270,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"default"]
5:I[85455,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"default"]
6:I[51506,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js","/_next/static/chunks/bf98b467f5036c3d.js","/_next/static/chunks/948615c9ecde1cb4.js","/_next/static/chunks/c84805df17f0a72a.js","/_next/static/chunks/0e5a02cd06292d2b.js","/_next/static/chunks/85806e5b63a62879.js","/_next/static/chunks/f87ca1afb6e89cb0.js","/_next/static/chunks/311bfda68bef2673.js","/_next/static/chunks/e1a9aaa3e8d4ba89.js","/_next/static/chunks/8fba60bd4135542a.js"],""]
7:I[53013,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js"],"default"]
c:I[7871,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"default"]
:HL["/_next/static/chunks/9cf24ed64efb86d5.css","style"]
0:{"P":null,"b":"bxs8AMhlcLhPuTMmFoUNL","c":["","posts","pgvector-two-stage-search-optimization"],"q":"","i":false,"f":[[["",{"children":["posts",{"children":[["slug","pgvector-two-stage-search-optimization","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/9cf24ed64efb86d5.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","script","script-0",{"src":"/_next/static/chunks/94ee590fcdd715f5.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/cde3ff9ca0393567.js","async":true,"nonce":"$undefined"}],["$","script","script-2",{"src":"/_next/static/chunks/fec9c5c27cbc91d6.js","async":true,"nonce":"$undefined"}]],["$","html",null,{"lang":"ko","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\n  (function() {\n    try {\n      var theme = localStorage.getItem('theme');\n      if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {\n        document.documentElement.classList.add('dark');\n      } else {\n        document.documentElement.classList.remove('dark');\n      }\n    } catch (e) {}\n  })();\n"}}],["$","link",null,{"rel":"shortcut icon","href":"/favicon-light.svg"}],["$","link",null,{"rel":"icon","href":"/favicon-light.svg"}],["$","link",null,{"rel":"apple-touch-icon","href":"/favicon-light.svg"}]]}],["$","body",null,{"className":"min-h-screen flex flex-col bg-background text-foreground antialiased","children":[["$","$L2",null,{"children":[["$","$L3",null,{}],["$","main",null,{"className":"flex-1 flex flex-col","children":["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"border-t border-border","children":["$","div",null,{"className":"max-w-4xl mx-auto px-6 sm:px-8 md:px-12 lg:px-16 py-6 flex flex-col sm:flex-row items-center justify-between gap-2 text-sm text-muted-foreground","children":[["$","span",null,{"children":"© 2025 anveloper.dev"}],["$","nav",null,{"className":"flex items-center gap-3","children":[["$","span","GitHub",{"className":"flex items-center gap-3","children":[false,["$","$L6",null,{"href":"https://github.com/anveloper","className":"hover:text-foreground transition-colors","target":"_blank","rel":"noopener noreferrer","children":"GitHub"}]]}],["$","span","LinkedIn",{"className":"flex items-center gap-3","children":[["$","span",null,{"aria-hidden":true,"children":"·"}],["$","$L6",null,{"href":"https://www.linkedin.com/in/anveloper","className":"hover:text-foreground transition-colors","target":"_blank","rel":"noopener noreferrer","children":"LinkedIn"}]]}],["$","span","Contact",{"className":"flex items-center gap-3","children":[["$","span",null,{"aria-hidden":true,"children":"·"}],["$","$L6",null,{"href":"/contact","className":"hover:text-foreground transition-colors","children":"Contact"}]]}]]}]]}]}]]}],["$","$L7",null,{}]]}]]}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["$L8",{"children":["$L9",{},null,false,false]},null,false,false]},null,false,false]},["$La",[],[]],false,false],"$Lb",false]],"m":"$undefined","G":["$c",[]],"S":true}
e:I[95276,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"OutletBoundary"]
f:"$Sreact.suspense"
11:I[95276,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"ViewportBoundary"]
13:I[95276,["/_next/static/chunks/221e0744b683f94b.js","/_next/static/chunks/90c5a27ffb71fa4a.js"],"MetadataBoundary"]
8:["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}]
9:["$","$1","c",{"children":["$Ld",[["$","script","script-0",{"src":"/_next/static/chunks/bf98b467f5036c3d.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/948615c9ecde1cb4.js","async":true,"nonce":"$undefined"}],["$","script","script-2",{"src":"/_next/static/chunks/c84805df17f0a72a.js","async":true,"nonce":"$undefined"}],["$","script","script-3",{"src":"/_next/static/chunks/0e5a02cd06292d2b.js","async":true,"nonce":"$undefined"}],["$","script","script-4",{"src":"/_next/static/chunks/85806e5b63a62879.js","async":true,"nonce":"$undefined"}],["$","script","script-5",{"src":"/_next/static/chunks/f87ca1afb6e89cb0.js","async":true,"nonce":"$undefined"}],["$","script","script-6",{"src":"/_next/static/chunks/311bfda68bef2673.js","async":true,"nonce":"$undefined"}],["$","script","script-7",{"src":"/_next/static/chunks/e1a9aaa3e8d4ba89.js","async":true,"nonce":"$undefined"}],["$","script","script-8",{"src":"/_next/static/chunks/8fba60bd4135542a.js","async":true,"nonce":"$undefined"}]],["$","$Le",null,{"children":["$","$f",null,{"name":"Next.MetadataOutlet","children":"$@10"}]}]]}]
a:["$","svg","l",{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-loader h-11 w-11 absolute m-auto top-0 bottom-0 right-0 left-0 animate-spin text-muted-foreground z-50","aria-hidden":"true","children":[["$","path","3427ic",{"d":"M12 2v4"}],["$","path","r700ao",{"d":"m16.2 7.8 2.9-2.9"}],["$","path","wj9ykh",{"d":"M18 12h4"}],["$","path","1bxg5t",{"d":"m16.2 16.2 2.9 2.9"}],["$","path","jadmvz",{"d":"M12 18v4"}],["$","path","bwix9q",{"d":"m4.9 19.1 2.9-2.9"}],["$","path","j09sii",{"d":"M2 12h4"}],["$","path","giyufr",{"d":"m4.9 4.9 2.9 2.9"}],"$undefined"]}]
b:["$","$1","h",{"children":[null,["$","$L11",null,{"children":"$L12"}],["$","div",null,{"hidden":true,"children":["$","$L13",null,{"children":["$","$f",null,{"name":"Next.Metadata","children":"$L14"}]}]}],null]}]
12:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
15:I[66627,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js","/_next/static/chunks/bf98b467f5036c3d.js","/_next/static/chunks/948615c9ecde1cb4.js","/_next/static/chunks/c84805df17f0a72a.js","/_next/static/chunks/0e5a02cd06292d2b.js","/_next/static/chunks/85806e5b63a62879.js","/_next/static/chunks/f87ca1afb6e89cb0.js","/_next/static/chunks/311bfda68bef2673.js","/_next/static/chunks/e1a9aaa3e8d4ba89.js","/_next/static/chunks/8fba60bd4135542a.js"],"TableOfContents"]
d:["$","div",null,{"className":"pt-28 pb-8 px-6 sm:px-8 md:px-12 lg:px-16 md:pt-20 min-h-screen","children":["$","div",null,{"className":"w-full max-w-4xl mx-auto","children":[["$","$L15",null,{"items":[{"id":"pgvector-postgresql의-벡터-검색-확장","text":"pgvector: PostgreSQL의 벡터 검색 확장","level":2},{"id":"인덱스-hnsw-vs-ivfflat","text":"인덱스: HNSW vs IVFFlat","level":3},{"id":"배경","text":"배경","level":2},{"id":"2단계-검색이란","text":"2단계 검색이란","level":2},{"id":"스키마-설계-halfvec--파티셔닝","text":"스키마 설계: halfvec + 파티셔닝","level":2},{"id":"핵심-테이블","text":"핵심 테이블","level":3},{"id":"halfvecfloat16","text":"halfvec(float16)","level":3},{"id":"hnsw-인덱스","text":"HNSW 인덱스","level":3},{"id":"검색-쿼리","text":"검색 쿼리","level":2},{"id":"인프라-비용-비교-핵심-효과","text":"인프라 비용 비교: 핵심 효과","level":2},{"id":"월-인프라-비용-비교","text":"월 인프라 비용 비교","level":3},{"id":"검색-성능","text":"검색 성능","level":3},{"id":"인덱싱-전략별-비교","text":"인덱싱 전략별 비교","level":2},{"id":"1000만-건-비교","text":"1,000만 건 비교","level":3},{"id":"임베딩-비용","text":"임베딩 비용","level":2},{"id":"단계별-확장-로드맵","text":"단계별 확장 로드맵","level":2},{"id":"정리","text":"정리","level":2}]}],["$","$L6",null,{"href":"/posts","className":"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-6","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left w-4 h-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],["$","span",null,{"children":"포스트 목록으로 돌아가기"}]]}],["$","header",null,{"className":"border-b border-border pb-6 mb-8","children":[["$","h1",null,{"className":"text-2xl sm:text-3xl font-bold text-foreground mb-4","children":"pgvector 2단계 검색 전략으로 벡터 검색 비용 1/6로 줄이기"}],["$","div",null,{"className":"flex flex-wrap items-center gap-4 mb-4","children":["$","span",null,{"className":"text-sm text-muted-foreground","children":"2026-02-10"}]}],["$","div",null,{"className":"flex flex-wrap gap-2","children":[["$","div","pgvector",{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80","children":"pgvector"}],["$","div","PostgreSQL",{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80","children":"PostgreSQL"}],["$","div","Vector Search",{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80","children":"Vector Search"}],["$","div","RAG",{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80","children":"RAG"}],["$","div","OpenAI",{"className":"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80","children":"OpenAI"}]]}]]}],["$","article",null,{"className":"prose prose-neutral dark:prose-invert max-w-none","children":"$L16"}]]}]}]
10:null
14:[["$","title","0",{"children":"pgvector 2단계 검색 전략으로 벡터 검색 비용 1/6로 줄이기 | 안성진"}],["$","meta","1",{"name":"description","content":"LLM의 사전 분류와 PostgreSQL 파티셔닝을 결합한 2단계 검색 전략으로, 2000만 건 규모의 벡터 검색 인프라 비용을 대폭 절감한 과정을 정리했다."}],["$","meta","2",{"name":"keywords","content":"pgvector,PostgreSQL,Vector Search,RAG,OpenAI"}],["$","meta","3",{"name":"robots","content":"index, follow"}],["$","meta","4",{"name":"google-site-verification","content":"kpYkq06WB0cQDLByVOdZD_5HXLkbxzFAvQKQ-Rp9sKY"}],["$","meta","5",{"property":"og:title","content":"pgvector 2단계 검색 전략으로 벡터 검색 비용 1/6로 줄이기"}],["$","meta","6",{"property":"og:description","content":"LLM의 사전 분류와 PostgreSQL 파티셔닝을 결합한 2단계 검색 전략으로, 2000만 건 규모의 벡터 검색 인프라 비용을 대폭 절감한 과정을 정리했다."}],["$","meta","7",{"property":"og:url","content":"https://anveloper.dev/posts/pgvector-two-stage-search-optimization"}],["$","meta","8",{"property":"og:type","content":"article"}],["$","meta","9",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","10",{"name":"twitter:title","content":"pgvector 2단계 검색 전략으로 벡터 검색 비용 1/6로 줄이기"}],["$","meta","11",{"name":"twitter:description","content":"LLM의 사전 분류와 PostgreSQL 파티셔닝을 결합한 2단계 검색 전략으로, 2000만 건 규모의 벡터 검색 인프라 비용을 대폭 절감한 과정을 정리했다."}]]
16:[["$","h1",null,{"id":"pgvector-2단계-검색-전략으로-벡터-검색-비용-16로-줄이기","children":"pgvector 2단계 검색 전략으로 벡터 검색 비용 1/6로 줄이기","className":"text-4xl font-bold mt-10 mb-5 text-foreground"}],"\n",["$","h2",null,{"id":"pgvector-postgresql의-벡터-검색-확장","children":"pgvector: PostgreSQL의 벡터 검색 확장","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}],"\n",["$","p",null,{"children":["pgvector는 PostgreSQL에 벡터 유사도 검색 기능을 추가하는 오픈소스 확장이다. 전용 벡터 DB(Pinecone, Milvus, Qdrant)와 달리, ",["$","strong",null,{"children":"기존 PostgreSQL 인프라에서 관계형 데이터와 벡터를 통합 관리","className":"font-semibold text-foreground"}],"할 수 있다는 것이 최대 장점이다. 별도 인프라 없이 JOIN, 트랜잭션, 인덱스 등 PostgreSQL의 모든 기능을 벡터 데이터와 함께 사용할 수 있다."],"className":"my-5 leading-7 text-foreground/90"}],"\n",["$","h3",null,{"id":"인덱스-hnsw-vs-ivfflat","children":"인덱스: HNSW vs IVFFlat","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}],"\n",["$","p",null,{"children":"pgvector는 두 가지 근사 최근접 이웃(ANN) 인덱스를 지원한다.","className":"my-5 leading-7 text-foreground/90"}],"\n",["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"항목","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"HNSW","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"IVFFlat","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"검색 속도","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"빠름 (speed-recall 트레이드오프 우수)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"보통","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"빌드 속도","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"느림","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"빠름","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"메모리 사용","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"높음","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"낮음","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"데이터 없이 빌드","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"가능","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"불가 (학습 단계 필요)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"동적 데이터","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"강함 (삽입/삭제 영향 적음)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"약함 (재빌드 권장)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}],"\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b","\n","$L4c","\n","$L4d","\n","$L4e"]
4f:I[63508,["/_next/static/chunks/94ee590fcdd715f5.js","/_next/static/chunks/cde3ff9ca0393567.js","/_next/static/chunks/fec9c5c27cbc91d6.js","/_next/static/chunks/bf98b467f5036c3d.js","/_next/static/chunks/948615c9ecde1cb4.js","/_next/static/chunks/c84805df17f0a72a.js","/_next/static/chunks/0e5a02cd06292d2b.js","/_next/static/chunks/85806e5b63a62879.js","/_next/static/chunks/f87ca1afb6e89cb0.js","/_next/static/chunks/311bfda68bef2673.js","/_next/static/chunks/e1a9aaa3e8d4ba89.js","/_next/static/chunks/8fba60bd4135542a.js"],"Mermaid"]
17:["$","p",null,{"children":["v0.7.0에서 도입된 ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"halfvec"}]}]}]}],"(float16) 타입은 벡터 저장 공간을 ",["$","strong",null,{"children":"50% 절감","className":"font-semibold text-foreground"}],"하면서도 검색 품질(recall) 손실이 거의 없다. 또한 ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"halfvec"}]}]}]}],"은 HNSW에서 ",["$","strong",null,{"children":"4000차원","className":"font-semibold text-foreground"}],"까지 지원하여, ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"vector"}]}]}]}],"(float32)의 2000차원 제한을 넘어 대형 임베딩 모델(OpenAI 3072차원 등)과의 호환성이 높다."],"className":"my-5 leading-7 text-foreground/90"}]
18:["$","p",null,{"children":["v0.8.0에서는 ",["$","strong",null,{"children":"반복 스캐닝","className":"font-semibold text-foreground"}],"(iterative scan)이 추가되어, 필터 조건과 벡터 검색을 결합할 때 결과가 부족한 \"오버필터링\" 문제를 해결했다. ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"hnsw.iterative_scan"}]}]}]}],"과 ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"ivfflat.iterative_scan"}]}]}]}]," 파라미터로 활성화할 수 있다."],"className":"my-5 leading-7 text-foreground/90"}]
19:["$","p",null,{"children":["이 글에서는 pgvector의 HNSW + halfvec에 PostgreSQL 파티셔닝과 LLM 사전 분류를 결합한 ",["$","strong",null,{"children":"2단계 검색 전략","className":"font-semibold text-foreground"}],"으로, 2,000만 건 규모에서 인프라 비용을 1/6로 줄인 과정을 정리한다."],"className":"my-5 leading-7 text-foreground/90"}]
1a:["$","h2",null,{"id":"배경","children":"배경","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
1b:["$","p",null,{"children":"디자인 템플릿 AI 생성 시스템에서 RAG(검색 증강 생성)를 구현해야 했다. 사용자가 \"미니멀한 흑백 명함\"이라고 요청하면, DB에서 유사한 기존 템플릿을 검색하여 AI가 참고하도록 하는 구조다.","className":"my-5 leading-7 text-foreground/90"}]
1c:["$","p",null,{"children":"문제는 규모다. 기본 템플릿 ~1,000만 건, 사용자 커스텀 포함 최대 ~2,000만 건의 XML 디자인 데이터를 벡터 검색해야 한다. 전용 벡터 DB(Milvus, Pinecone)를 도입하면 인프라 복잡도가 올라가고, 메타데이터와의 조인이 번거롭다.","className":"my-5 leading-7 text-foreground/90"}]
1d:["$","p",null,{"children":["PostgreSQL의 pgvector 확장을 선택했다. 관계형 데이터와 벡터를 단일 DB에서 통합 관리할 수 있기 때문이다. 하지만 2,000만 건 규모의 벡터 인덱스를 메모리에 올리려면 서버 사양이 상당히 높아야 했다. 이 문제를 해결한 것이 ",["$","strong",null,{"children":"2단계 검색 전략","className":"font-semibold text-foreground"}],"이다."],"className":"my-5 leading-7 text-foreground/90"}]
1e:["$","h2",null,{"id":"2단계-검색이란","children":"2단계 검색이란","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
1f:["$","p",null,{"children":["사용자 입력에서 ",["$","strong",null,{"children":"생산 타입(POD_TYPE)을 먼저 분류","className":"font-semibold text-foreground"}],"한 뒤, 해당 파티션 내에서만 벡터 검색을 수행하는 전략이다."],"className":"my-5 leading-7 text-foreground/90"}]
20:["$","$L4f",null,{"chart":"flowchart TD\n    Input[&quot;사용자: 미니멀한 흑백 명함 만들어줘&quot;] --> S1\n\n    subgraph S1[&quot;Stage 1 — Orchestrator (Claude Sonnet)&quot;]\n        direction LR\n        Classify[&quot;LLM이 프롬프트에서 생산 타입 분류&quot;]\n        Classify --> Type[&quot;pod_type: namecard&quot;]\n        Classify --> Query[&quot;search_query: 미니멀 흑백 비즈니스 카드&quot;]\n    end\n\n    S1 --> S2\n\n    subgraph S2[&quot;Stage 2 — Retriever (OpenAI Embedding + pgvector)&quot;]\n        direction LR\n        Filter[&quot;WHERE POD_TYPE = 'namecard' 파티션만 검색&quot;]\n        Filter --> Scan[&quot;전체 2,000만 건 중 ~200만 건만 스캔&quot;]\n    end\n\n    S2 --> Result[&quot;유사 템플릿 top-k 반환&quot;]"}]
21:["$","p",null,{"children":["Stage 1의 POD_TYPE 분류는 LLM(Orchestrator)이 수행한다. \"명함 만들어줘\" → ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"namecard"}]}]}]}],", \"티셔츠 디자인\" → ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"tshirt"}]}]}]}],"처럼 비교적 단순한 분류 작업이므로, 별도 비용 없이 기존 오케스트레이션 과정에서 함께 처리한다."],"className":"my-5 leading-7 text-foreground/90"}]
22:["$","h2",null,{"id":"스키마-설계-halfvec--파티셔닝","children":"스키마 설계: halfvec + 파티셔닝","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
23:["$","h3",null,{"id":"핵심-테이블","children":"핵심 테이블","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
24:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"tabIndex":"0","data-language":"sql","data-theme":"github-dark github-light","children":["$","code",null,{"data-language":"sql","data-theme":"github-dark github-light","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- 생산 타입 마스터 (~50종)"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"CREATE"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TABLE"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" \""}],["$","span",null,{"style":{"--shiki-dark":"#B392F0","--shiki-light":"#6F42C1"},"children":"T_POD_TYPE"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"\" ("}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TEXT"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" PRIMARY KEY"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":",  "}],["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- namecard, tshirt, leaflet 등"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"NAME\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TEXT"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" NOT NULL"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":");"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- 템플릿 (메타데이터 + 벡터) — POD_TYPE 파티셔닝"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"CREATE"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TABLE"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" \""}],["$","span",null,{"style":{"--shiki-dark":"#B392F0","--shiki-light":"#6F42C1"},"children":"T_TEMPLATE"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"\" ("}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"SEQNO\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" SERIAL"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TEXT"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" NOT NULL"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" REFERENCES"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"T_POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"NAME\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TEXT"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" NOT NULL"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"XML_CONTENT\""}],"$L50","$L51","$L52"]}],"\n","$L53","\n","$L54","\n","$L55","\n","$L56","\n","$L57","\n","$L58","\n","$L59","\n","$L5a","\n","$L5b","\n","$L5c"]}]}],"className":"not-prose my-6"}]
25:["$","p",null,{"children":"두 가지 핵심 결정이 있다.","className":"my-5 leading-7 text-foreground/90"}]
26:["$","h3",null,{"id":"halfvecfloat16","children":"halfvec(float16)","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
27:["$","p",null,{"children":["OpenAI text-embedding-3-large의 3072차원 벡터를 ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"vector(3072)"}]}]}]}]," 대신 ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"halfvec(3072)"}]}]}]}],"로 저장한다."],"className":"my-5 leading-7 text-foreground/90"}]
28:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"타입","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"1건 크기","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"100만 건","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"2,000만 건","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"vector (float32)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"12.0 KB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"11.4 GB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"229 GB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"halfvec (float16)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"6.0 KB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"5.7 GB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"114 GB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
29:["$","p",null,{"children":"저장 50% 절감이면서, 검색 정확도(recall) 손실은 거의 없다. 또한 halfvec은 HNSW 인덱스에서 4000차원까지 지원하므로, 3072차원에서도 HNSW를 사용할 수 있다 (vector 타입은 2000차원 제한).","className":"my-5 leading-7 text-foreground/90"}]
2a:["$","h3",null,{"id":"hnsw-인덱스","children":"HNSW 인덱스","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
2b:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"tabIndex":"0","data-language":"sql","data-theme":"github-dark github-light","children":["$","code",null,{"data-language":"sql","data-theme":"github-dark github-light","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"CREATE"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" INDEX"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" \""}],["$","span",null,{"style":{"--shiki-dark":"#B392F0","--shiki-light":"#6F42C1"},"children":"IDX_TEMPLATE_EMBEDDING_HNSW"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"\""}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"    ON"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"T_TEMPLATE\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" USING"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" hnsw ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"EMBEDDING\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" halfvec_cosine_ops)"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"    WITH"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" (m "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"="}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":" 16"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":", ef_construction "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"="}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":" 64"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- 검색 시 정확도 조절"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"SET"}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":" hnsw"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"."}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"ef_search"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":" 100"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":";"}]]}]]}]}],"className":"not-prose my-6"}]
2c:["$","p",null,{"children":"파티션 테이블에 인덱스를 생성하면 각 파티션별로 자동 생성된다. 인덱스 빌드 메모리도 파티션 단위로 분산된다.","className":"my-5 leading-7 text-foreground/90"}]
2d:["$","h2",null,{"id":"검색-쿼리","children":"검색 쿼리","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
2e:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"tabIndex":"0","data-language":"sql","data-theme":"github-dark github-light","children":["$","code",null,{"data-language":"sql","data-theme":"github-dark github-light","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"SELECT"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"SEQNO\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":", "}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"NAME\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":", "}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"       1"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" -"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"EMBEDDING\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" <=>"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" $"}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"1"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"::halfvec) "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"AS"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" similarity"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"FROM"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"T_TEMPLATE\""}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"WHERE"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" ="}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" $"}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"2"}],["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"  -- Stage 1에서 LLM이 분류한 생산 타입"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"ORDER BY"}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":" \"EMBEDDING\""}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" <=>"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" $"}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"1"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"::halfvec"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"LIMIT"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" $"}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"3"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":";"}]]}]]}]}],"className":"not-prose my-6"}]
2f:["$","p",null,{"children":[["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"<=>"}]}]}]}]," 연산자가 코사인 거리다. ",["$","span",null,{"data-rehype-pretty-code-figure":"","children":["$","code",null,{"data-language":"plaintext","data-theme":"github-dark github-light","style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"children":["$","span",null,{"data-line":"","children":["$","span",null,{"children":"WHERE \"POD_TYPE\" = $2"}]}]}]}]," 조건으로 PostgreSQL이 자동으로 파티션 프루닝을 수행하여, 해당 파티션의 HNSW 인덱스만 사용한다."],"className":"my-5 leading-7 text-foreground/90"}]
30:["$","p",null,{"children":"Python(asyncpg) 구현:","className":"my-5 leading-7 text-foreground/90"}]
31:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"--shiki-dark":"#e1e4e8","--shiki-light":"#24292e","--shiki-dark-bg":"#24292e","--shiki-light-bg":"#fff"},"tabIndex":"0","data-language":"python","data-theme":"github-dark github-light","children":["$","code",null,{"data-language":"python","data-theme":"github-dark github-light","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"vector "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"="}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" np.array(query_embedding, "}],["$","span",null,{"style":{"--shiki-dark":"#FFAB70","--shiki-light":"#E36209"},"children":"dtype"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"="}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"np.float16)"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"rows "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"="}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" await"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" pool.fetch("}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    'SELECT \"SEQNO\", \"NAME\", \"POD_TYPE\", '"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    '1 - (\"EMBEDDING\" <=> $1::halfvec) AS similarity '"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    'FROM \"T_TEMPLATE\" WHERE \"POD_TYPE\" = $2 '"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    'ORDER BY \"EMBEDDING\" <=> $1::halfvec LIMIT $3'"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"    vector, pod_type, top_k"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":")"}]}]]}]}],"className":"not-prose my-6"}]
32:["$","h2",null,{"id":"인프라-비용-비교-핵심-효과","children":"인프라 비용 비교: 핵심 효과","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
33:["$","p",null,{"children":["2단계 검색의 가장 큰 가치는 ",["$","strong",null,{"children":"검색 속도 향상이 아닌 인프라 사이징 최적화","className":"font-semibold text-foreground"}],"다."],"className":"my-5 leading-7 text-foreground/90"}]
34:["$","p",null,{"children":["HNSW 인덱스는 메모리에 올라가야 성능이 나온다. 2단계 검색이 없으면 전체 데이터 기준으로 서버를 사이징해야 하지만, 2단계 검색을 적용하면 ",["$","strong",null,{"children":"최대 파티션 크기 기준","className":"font-semibold text-foreground"}],"으로 사이징하면 된다."],"className":"my-5 leading-7 text-foreground/90"}]
35:["$","p",null,{"children":"10개 POD_TYPE 균등 분포 기준:","className":"my-5 leading-7 text-foreground/90"}]
36:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"전체 데이터","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"파티션당 검색 대상","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"100만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~10만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"1,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~100만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"2,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~200만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
37:["$","h3",null,{"id":"월-인프라-비용-비교","children":"월 인프라 비용 비교","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
38:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"규모","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"2단계 검색 미적용","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"2단계 검색 적용","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"절감률","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"100만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~57만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~25만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"56%","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"1,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~384만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~57만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"85%","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"2,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"~564만 원","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"~102만 원","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"82%","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
39:["$","p",null,{"children":["2,000만 건 기준으로 월 ",["$","strong",null,{"children":"462만 원","className":"font-semibold text-foreground"}]," 절감. 연간으로 환산하면 약 5,500만 원이다."],"className":"my-5 leading-7 text-foreground/90"}]
3a:["$","h3",null,{"id":"검색-성능","children":"검색 성능","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
3b:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"규모","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"2단계 검색 미적용","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"2단계 검색 적용","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"100만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"5~20ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"2~5ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"1,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"20~80ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"5~15ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"2,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"40~150ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"5~20ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
3c:["$","p",null,{"children":"검색 레이턴시도 개선되지만, 핵심은 인프라 비용 절감이다.","className":"my-5 leading-7 text-foreground/90"}]
3d:["$","h2",null,{"id":"인덱싱-전략별-비교","children":"인덱싱 전략별 비교","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
3e:["$","p",null,{"children":"4가지 전략을 검토했다.","className":"my-5 leading-7 text-foreground/90"}]
3f:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"전략","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"차원","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"인덱스","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"특징","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"A. halfvec + HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"3072 (f16)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"저장 50% 절감, 정확도 유지","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"B. 파티셔닝 + A + 2단계 검색","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"3072 (f16)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"HNSW (파티션별)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"인프라 비용 대폭 절감","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"C. 1536차원 + HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"1536 (f32)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"정확도 ~5% 하락","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"D. 전용 Vector DB","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"3072","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"자체","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"인프라 복잡, 현재 규모에서 불필요","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
40:["$","h3",null,{"id":"1000만-건-비교","children":"1,000만 건 비교","className":"text-2xl font-semibold mt-8 mb-3 text-foreground"}]
41:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"전략","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"API (1회)","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"월 인프라","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"검색 레이턴시","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"Recall@10","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"A. halfvec + HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$225","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~384만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"20~80ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~98%","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"B. 파티셔닝 + 2단계","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$225","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"~57만 원","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"5~15ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~99%","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"C. 1536 + HNSW","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$225","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~192만 원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"15~50ms","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"~94%","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
42:["$","p",null,{"children":"전략 B가 비용, 성능, 정확도 모든 면에서 우위다. 전략 C는 halfvec 3072와 저장 용량이 같으면서 정확도만 5% 하락하므로 비권장이다.","className":"my-5 leading-7 text-foreground/90"}]
43:["$","h2",null,{"id":"임베딩-비용","children":"임베딩 비용","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
44:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"항목","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"값","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"모델","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"OpenAI text-embedding-3-large","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"차원","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"3072","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"단가 (Batch API)","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$0.065 / 1M tokens","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
45:["$","div",null,{"className":"my-8 overflow-x-auto bg-card rounded-lg border border-border","children":["$","table",null,{"className":"w-full border-collapse","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"규모","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"총 토큰","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"Standard","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}],["$","th",null,{"children":"Batch (50% 할인)","className":"border-b border-r border-border px-4 py-2 text-left font-semibold last:border-r-0"}]]}],"className":"bg-muted"}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"100만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"3억","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$39","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"$$19.5","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"1,000만 건","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"30억","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":"$$390","className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}],["$","td",null,{"children":["$","strong",null,{"children":"$$195","className":"font-semibold text-foreground"}],"className":"border-b border-r border-border px-4 py-2 last:border-r-0 [tr:last-child_&]:border-b-0"}]]}]]}]]}]}]
46:["$","p",null,{"children":"임베딩은 1회성 인덱싱 비용이다. Batch API를 사용하면 50% 할인을 받을 수 있다.","className":"my-5 leading-7 text-foreground/90"}]
47:["$","h2",null,{"id":"단계별-확장-로드맵","children":"단계별 확장 로드맵","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
48:["$","p",null,{"children":"처음부터 파티셔닝으로 시작하여, Phase 전환 시 스키마 마이그레이션을 제거했다.","className":"my-5 leading-7 text-foreground/90"}]
49:["$","$L4f",null,{"chart":"flowchart LR\n    P1[&quot;Phase 1\\n100만 건\\nAPI ~$22.5\\n월 ~25만 원&quot;] -->|데이터 추가| P2[&quot;Phase 2\\n1,000만 건\\nAPI ~$225\\n월 ~57만 원&quot;] -->|데이터 추가| P3[&quot;Phase 3\\n2,000만 건\\nAPI ~$450\\n월 ~102만 원&quot;]"}]
4a:["$","p",null,{"children":"Phase 1부터 파티셔닝을 적용하면 100만 건에서 오버헤드는 무시할 수준이면서, Phase 2/3 전환 시 데이터만 추가하면 된다.","className":"my-5 leading-7 text-foreground/90"}]
4b:["$","h2",null,{"id":"정리","children":"정리","className":"text-3xl font-semibold mt-9 mb-4 text-foreground border-b border-border pb-2"}]
4c:["$","p",null,{"children":"2단계 검색 전략의 핵심은 세 가지다.","className":"my-5 leading-7 text-foreground/90"}]
4d:["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"LLM 분류와 DB 파티셔닝의 결합","className":"font-semibold text-foreground"}],": Orchestrator가 이미 수행하는 작업(사용자 의도 분석)에 POD_TYPE 분류를 추가한 것이므로, 별도 비용 없이 검색 범위를 1/10로 줄일 수 있다."],"className":"my-5 leading-7 text-foreground/90"}],"\n"],"className":"text-foreground/90 leading-7"}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"halfvec으로 정확도 유지 + 비용 절감","className":"font-semibold text-foreground"}],": float16 저장으로 용량 50% 절감하면서, 3072차원을 유지하여 임베딩 정확도 손실이 없다."],"className":"my-5 leading-7 text-foreground/90"}],"\n"],"className":"text-foreground/90 leading-7"}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"처음부터 파티셔닝으로 시작","className":"font-semibold text-foreground"}],": 100만 건이든 2,000만 건이든 동일한 스키마로 운영하여, 확장 시 마이그레이션 비용을 제거했다."],"className":"my-5 leading-7 text-foreground/90"}],"\n"],"className":"text-foreground/90 leading-7"}],"\n"],"className":"my-5 ml-6 list-decimal space-y-2"}]
4e:["$","p",null,{"children":"전용 벡터 DB를 도입하지 않고 PostgreSQL 하나로 관계형 데이터와 벡터 검색을 통합한 덕분에, 인프라 운영 복잡도도 최소화할 수 있었다.","className":"my-5 leading-7 text-foreground/90"}]
50:["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TEXT"}]
51:["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" NOT NULL"}]
52:["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":","}]
53:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"    \"EMBEDDING\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" halfvec("}],["$","span",null,{"style":{"--shiki-dark":"#79B8FF","--shiki-light":"#005CC5"},"children":"3072"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":"),"}]]}]
54:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"    PRIMARY KEY"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"SEQNO\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":", "}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":")"}]]}]
55:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":") "}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"PARTITION"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" BY"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" LIST ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"POD_TYPE\""}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":");"}]]}]
56:["$","span",null,{"data-line":"","children":" "}]
57:["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- 파티션 생성"}]}]
58:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"CREATE"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TABLE"}],["$","span",null,{"style":{"--shiki-dark":"#B392F0","--shiki-light":"#6F42C1"},"children":" t_template_namecard"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" PARTITION"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" OF "}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"T_TEMPLATE\""}]]}]
59:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"    FOR"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" VALUES"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" IN"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"'namecard'"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":");"}]]}]
5a:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"CREATE"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" TABLE"}],["$","span",null,{"style":{"--shiki-dark":"#B392F0","--shiki-light":"#6F42C1"},"children":" t_template_tshirt"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" PARTITION"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" OF "}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"\"T_TEMPLATE\""}]]}]
5b:["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":"    FOR"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" VALUES"}],["$","span",null,{"style":{"--shiki-dark":"#F97583","--shiki-light":"#D73A49"},"children":" IN"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":" ("}],["$","span",null,{"style":{"--shiki-dark":"#9ECBFF","--shiki-light":"#032F62"},"children":"'tshirt'"}],["$","span",null,{"style":{"--shiki-dark":"#E1E4E8","--shiki-light":"#24292E"},"children":");"}]]}]
5c:["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"--shiki-dark":"#6A737D","--shiki-light":"#6A737D"},"children":"-- ... ~50종"}]}]
